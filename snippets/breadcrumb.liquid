{%- liquid
  comment 'Breadcrumb navigation with working hierarchy and URL mapping'
  endcomment
  assign menu_handle = 'main-menu'
  assign main_menu = linklists[menu_handle]
  assign menu_path = blank

  comment 'Build menu path for products and collections'
  endcomment
  if request.page_type == 'product' and product and main_menu
    for link in main_menu.links
      if link.url == collection.url or link.title contains 'N·ªôi th·∫•t vƒÉn ph√≤ng'
        for childlink in link.links
          if childlink.url == collection.url
            assign menu_path = link.title | append: '|' | append: childlink.title
            break
          endif
          if childlink.links != blank
            for grandchildlink in childlink.links
              if grandchildlink.url == collection.url
                assign menu_path = link.title | append: '|' | append: childlink.title | append: '|' | append: grandchildlink.title
                break
              endif
            endfor
            if menu_path != blank
              break
            endif
          endif
        endfor
        if menu_path != blank
          break
        endif
      endif
    endfor
  elsif request.page_type == 'collection' and collection and main_menu
    comment 'Find collection in menu hierarchy'
    endcomment
    for link in main_menu.links
      if link.url == collection.url
        assign menu_path = link.title
        break
      endif
      if link.links != blank
        for childlink in link.links
          if childlink.url == collection.url
            assign menu_path = link.title | append: '|' | append: childlink.title
            break
          endif
          if childlink.links != blank
            for grandchildlink in childlink.links
              if grandchildlink.url == collection.url
                assign menu_path = link.title | append: '|' | append: childlink.title | append: '|' | append: grandchildlink.title
                break
              endif
            endfor
            if menu_path != blank
              break
            endif
          endif
        endfor
        if menu_path != blank
          break
        endif
      endif
    endfor
  endif
  
  assign menu_levels = menu_path | split: '|'
  
  comment 'Initialize level_urls for URL mapping'
  endcomment
  assign level_urls = ''
-%}

<style>
  .breadcrumb {
    background: #f8f9fa !important;
    border-bottom: 1px solid #e5e7eb !important;
    padding: 12px 0 !important;
    font-size: 14px !important;
    z-index: -1 !important;
    position: relative !important;
  }
  
  .breadcrumb__list {
    display: flex !important;
    align-items: center !important;
    margin: 0 !important;
    padding: 0 !important;
    list-style: none !important;
    max-width: 1200px !important;
    margin: 0 auto !important;
    padding: 0 20px !important;
  }
  
  .breadcrumb__item {
    display: flex !important;
    align-items: center !important;
  }
  
  .breadcrumb__link {
    color: rgba(0, 0, 0, 0.6) !important;
    text-decoration: none !important;
    font-weight: 500 !important;
    transition: all 0.2s ease !important;
    font-size: 13px !important;
    font-family: 'Inter', 'Roboto', 'Noto Sans', var(--font-body-family), -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif !important;
  }
  
  .breadcrumb__link:hover {
    color: rgba(0, 0, 0, 1) !important;
    text-decoration: underline !important;
    font-weight: 600 !important;
  }
  
  .breadcrumb__current {
    color: rgba(0, 0, 0, 0.8) !important;
    font-weight: 600 !important;
    text-transform: none !important;
    font-size: 13px !important;
    font-family: 'Inter', 'Roboto', 'Noto Sans', var(--font-body-family), -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif !important;
  }
  
  .breadcrumb__separator {
    margin: 0 12px !important;
    color: rgba(0, 0, 0, 0.4) !important;
    font-size: 12px !important;
  }
</style>

<nav class="breadcrumb" aria-label="Breadcrumb">
  <ol class="breadcrumb__list">
    <!-- SIMPLE: Use buttons with onclick instead of <a> tags -->
    <li class="breadcrumb__item">
      <button type="button" onclick="window.location.href='/'" style="background: none; border: none; color: blue; text-decoration: underline; cursor: pointer; font: inherit;">
        üè† Trang ch·ªß
      </button>
    </li>
    <li class="breadcrumb__separator" aria-hidden="true">></li>
    <li class="breadcrumb__item">
      <button type="button" onclick="window.location.href='/collections/noi-that-van-phong'" style="background: none; border: none; color: blue; text-decoration: underline; cursor: pointer; font: inherit;">
        N·ªôi th·∫•t vƒÉn ph√≤ng
      </button>
    </li>
    <li class="breadcrumb__separator" aria-hidden="true">></li>
    <li class="breadcrumb__item">
      <button type="button" onclick="window.location.href='/collections/ban-van-phong'" style="background: none; border: none; color: blue; text-decoration: underline; cursor: pointer; font: inherit;">
        B√†n vƒÉn ph√≤ng
      </button>
    </li>
    <li class="breadcrumb__separator" aria-hidden="true">></li>
    <li class="breadcrumb__item">
      <span style="color: black; font-weight: bold;">B√†n l√†m vi·ªác</span>
    </li>
  </ol>
</nav>
